if (self.CavalryLogger) { CavalryLogger.start_js(["voT6H"]); }

__d("AlbumFeedGridSwitcher",["cx","Arbiter","CSS","Event","PageTransitions","ReactComposerEvents","Run","SimpleNUXMessage","SimpleNUXMessageTypes","SubscriptionsHandler","URI","ge"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=7;a=function(){__p&&__p();function a(a,c,d,e){__p&&__p();var f=this;this.$6=function(a){var c=(h||(h=b("URI"))).getRequestURI(!1).getQueryData();if(c.needsRefresh==="true"&&a.getQueryData().feed!==c.feed||!Object.prototype.hasOwnProperty.call(a.getQueryData(),"feed")&&!Object.prototype.hasOwnProperty.call(a.getQueryData(),"needsRefresh")){Object.prototype.hasOwnProperty.call(a.getQueryData(),"theater")&&b("Arbiter").subscribeOnce("PhotoSnowlift.CLOSE",function(){return b("PageTransitions").registerHandler(f.$6,i)});return!1}b("PageTransitions").transitionComplete();return!0};this.activateFeedView=function(){__p&&__p();if((h||(h=b("URI"))).getMostRecentURI().getQueryData().needsRefresh!=="true"){var a,c;(a=b("CSS")).addClass((c=b("ge"))("album_photos_pagelet"),"hidden_elem");a.removeClass(f.$3,"_aqp");a.removeClass(c("album_feed_pagelet"),"hidden_elem");a.addClass(f.$2,"_aqp");a.addClass(c("album_feedback_pagelet"),"hidden_elem");a.addClass(c("shared_album_nux"),"hidden_elem")}f.updateFeedURI("true")};this.activateGridView=function(){__p&&__p();if((h||(h=b("URI"))).getMostRecentURI().getQueryData().needsRefresh!=="true"){var a,c;(a=b("CSS")).addClass((c=b("ge"))("album_feed_pagelet"),"hidden_elem");a.removeClass(f.$2,"_aqp");a.removeClass(c("album_photos_pagelet"),"hidden_elem");a.addClass(f.$3,"_aqp");a.removeClass(c("album_feedback_pagelet"),"hidden_elem");a.removeClass(c("shared_album_nux"),"hidden_elem")}f.updateFeedURI("false")};this.$1=a;this.$2=c;this.$3=d;this.$4=e;this.$5=new(b("SubscriptionsHandler"))();this.$5.addSubscriptions(b("Event").listen(this.$2,"click",this.activateFeedView),b("Event").listen(this.$3,"click",this.activateGridView));this.$2.removeAttribute("disabled");this.$3.removeAttribute("disabled");b("CSS").removeClass(this.$3,"_42fr");b("CSS").removeClass(this.$2,"_42fr");b("Arbiter").subscribeOnce(b("ReactComposerEvents").POST_FINALLY,function(){var a=(h||(h=b("URI"))).getMostRecentURI(),c=a.getQueryData();c.needsRefresh="true";a.setQueryData(c);b("PageTransitions").go(a)});this.$4&&(this.$4.subscribe("hide",function(){b("SimpleNUXMessage").markMessageSeenByUser(b("SimpleNUXMessageTypes").ALBUMSV2_FEED_VIEW_SWITCHER)}),this.$4&&this.$4.show());b("Run").onLeave(this.cleanUp.bind(this));b("PageTransitions").registerHandler(this.$6,i);a=(h||(h=b("URI"))).getRequestURI(!1);c=a.getQueryData();c.needsRefresh&&(delete c.needsRefresh,b("PageTransitions").go(a.setQueryData(c)))}var c=a.prototype;c.cleanUp=function(){this.$5&&this.$5.release(),b("PageTransitions").removeHandler(this.$6)};c.updateFeedURI=function(a){var c=(h||(h=b("URI"))).getMostRecentURI(),d=c.getQueryData();d.feed=a;c.setQueryData(d);b("PageTransitions").go(c)};return a}();e.exports=a}),null);
__d("XAlbumFollowStatusController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/album/follow/",{album_id:{type:"Int"},action:{type:"Enum",enumType:0}})}),null);
__d("FollowAlbumButton",["csx","cx","AsyncRequest","CSS","DOM","Event","MarauderLogger","Run","SubscriptionsHandler","XAlbumFollowStatusController"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=500;a=function(){__p&&__p();function a(a,c,d,e){this.$1=a,this.$2=c,this.$3=d,this.$4=e,this.$5=new(b("SubscriptionsHandler"))(),this.$5.addSubscriptions(b("Event").listen(this.$2,"click",this.follow.bind(this)),b("Event").listen(this.$1,"click",function(a){a.preventDefault()})),this.$7=!1,this.$3&&this.$3.subscribe("itemclick",function(a,b){a=parseInt(b.item.getValue(),10);a===1?this.notifs():a===0?this.follow(null):a===2&&this.unfollow();this.$7=!0}.bind(this)),this.$3&&this.$3.subscribe("show",function(a,c){b("MarauderLogger").log("album_follow_status_cta_tapped","albums_follow_status_button",{album_id:this.$4.id,user_id:this.$4.userid})}.bind(this)),this.$3&&this.$3.subscribe("hide",function(a,c){this.$7||b("MarauderLogger").log("album_follow_status_cta_cancel","albums_follow_status_button",{album_id:this.$4.id,user_id:this.$4.userid}),this.$7=!1}.bind(this)),b("Run").onLeave(this.cleanUp.bind(this))}var c=a.prototype;c.getButtons=function(){return b("DOM").scry(this.$1,"._4o8q")};c.getSelected=function(){var a=this.getButtons(),c=null;a.forEach(function(a){var d=parseInt(a.getAttribute("data-status"),10);b("CSS").matchesSelector(a,"._4o8v")&&(c=d)});return c};c.follow=function(a){this.setSelected(0),a&&a.preventDefault(),a&&a.stopPropagation()};c.unfollow=function(){this.setSelected(2)};c.notifs=function(){this.setSelected(1)};c.updateSelectedUI=function(a){var c=a===2?2:0,d=this.getButtons();d.forEach(function(a){var d=parseInt(a.getAttribute("data-status"),10);d===c?b("CSS").addClass(a,"_2z1j"):b("CSS").removeClass(a,"_2z1j")});this.$3.forEachItem(function(c){a!==parseInt(c.getValue(),10)?b("CSS").addClass(c.getRoot(),"_2z1j"):b("CSS").removeClass(c.getRoot(),"_2z1j")})};c.setSelected=function(a){__p&&__p();this.$6=this.getSelected();this.updateSelectedUI(a);this.setLoading(!0);a=b("XAlbumFollowStatusController").getURIBuilder().setInt("album_id",this.$4.id).setEnum("action",a).getURI();new(b("AsyncRequest"))().setURI(a).setMethod("POST").setHandler(function(a){var b=this;this.updateSelectedUI(a.payload);setTimeout(function(){b.setLoading(!1)},i)}.bind(this)).setErrorHandler(function(a){var b=this;this.$6!==null&&this.updateSelectedUI(this.$6);setTimeout(function(){b.setLoading(!1)},i)}).send()};c.setLoading=function(a){this.$1&&b("CSS").conditionClass(this.$1,"_2z1k",a)};c.cleanUp=function(){this.$5&&this.$5.release()};return a}();e.exports=a}),null);
__d("XAlbumRequestContributorController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/album/requestcontributor/",{album_id:{type:"Int",required:!0},action:{type:"Enum",enumType:0}})}),null);
__d("RequestContributorAlbumButton",["csx","cx","AsyncRequest","CSS","DOM","Event","Run","SubscriptionsHandler","XAlbumRequestContributorController"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=500;a=function(){__p&&__p();function a(a,c,d,e){this.$1=a,this.$2=c,this.$3=d,this.$4=e,this.$5=new(b("SubscriptionsHandler"))(),this.$5.addSubscriptions(b("Event").listen(this.$2,"click",this.sendRequest.bind(this)),b("Event").listen(this.$3,"click",this.cancelRequest.bind(this))),b("Run").onLeave(this.cleanUp.bind(this))}var c=a.prototype;c.getButtons=function(){return b("DOM").scry(this.$1,"._2msd")};c.getSelected=function(){var a=this.getButtons(),c=null;a.forEach(function(a){var d=parseInt(a.getAttribute("data-status"),10);b("CSS").matchesSelector(a,"._2mso")&&(c=d)});return c};c.sendRequest=function(a){this.setSelected(1)};c.cancelRequest=function(a){this.setSelected(0)};c.updateSelectedUI=function(a){a=a===1?1:0;var c=this.getButtons();a?c.forEach(function(a){var c=parseInt(a.getAttribute("data-status"),10);b("CSS").conditionClass(a,"_2msa",c===1)}):c.forEach(function(a){var c=parseInt(a.getAttribute("data-status"),10);b("CSS").conditionClass(a,"_2msa",c===0)})};c.setSelected=function(a){__p&&__p();this.$6=this.getSelected();this.updateSelectedUI(a);this.setLoading(!0);a=b("XAlbumRequestContributorController").getURIBuilder().setInt("album_id",this.$4.id).setEnum("action",a).getURI();new(b("AsyncRequest"))().setURI(a).setMethod("POST").setHandler(function(a){var b=this;this.updateSelectedUI(a.payload);setTimeout(function(){b.setLoading(!1)},i)}.bind(this)).setErrorHandler(function(a){var b=this;this.$6!==null&&this.updateSelectedUI(this.$6);setTimeout(function(){b.setLoading(!1)},i)}).send()};c.setLoading=function(a){this.$1&&b("CSS").conditionClass(this.$1,"_2msb",a)};c.cleanUp=function(){this.$5&&this.$5.release()};return a}();e.exports=a}),null);
__d("ScrollLoader",["AsyncRequest","OnVisible"],(function(a,b,c,d,e,f){__p&&__p();a=function(){"use strict";function a(a,c,d,e){this.$1=new(b("OnVisible"))(a,function(){new(b("AsyncRequest"))(c).setRelativeTo(a).send()},d,e)}var c=a.prototype;c.destroy=function(){this.$1.remove(),this.$1=null};return a}();e.exports=a}),null);